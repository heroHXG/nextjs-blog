
本章目录
1、简单分析一下后端渲染，前端渲染，同构渲染
2、用过哪些服务端渲染方案？


### 一、简单分析一下后端渲染，前端渲染，同构渲染
1、后端渲染：传统的ASP,Java，或PHP的渲染机制
后端渲染：后端通过模板直接渲染HTML。页面交互能力有限。
优势：
   * 服务端渲染不需要事先下载一堆js 和 css 后才能看到页面（首屏性能）
   * SEO
   * 服务端渲染不用关心浏览器兼容性问题（随着浏览器发展，这个优点逐渐消失）
   * 对于电量不给力的手机或者平板，减少在客户端的电量消耗很重要

2、前端渲染：使用JS来渲染页面大部分内容，代表是现在流行的 SPA 单页面应用
优势：
   * 局部刷新。无需每次都进行完整页面请求。
   * 懒加载。如在页面初始时只加载可视区域内的数据，滚定后 rp 加载其他数据，可以通过react-lazyload 实现。
   * 富交互。使用JS实现各种炫酷效果。
   * 节约服务器成本。省电省钱，JS 支持CDN 部署，且部署极其简单，只需要服务器支持静态文件即可。
   * 天生的关注分离设计。服务器来访问数据库提供接口。JS只关注数据获取和展现。
   * js一次学习，到处使用。可以用来开发web，serve，mobile，desktop 类型的应用。

* 客户端渲染：后端负责处理数据，前端负责将数据渲染到页面中，相对独立，首屏渲染慢，不利于SEO。
+ 前端渲染CSR(Client Side Render):页面初始加载html，通过css优化页面显示，通过js优化交互。

3、同构渲染
同构渲染简单来说就是一份代码，服务端先通过服务端渲染（serve-side rendering），生成html 以及初始化数据，
客户端拿到代码和初始化数据后，通过对 html 的 dom 进行 patch 和事件绑定来对 dom 进行客户端激活（client-side hydration），这个整体的过程叫同构渲染。
优点：
   * 有助于SEO
   * 提高首屏性能

缺点： 
   * 性能
   * 不容忽视的服务器端和浏览器环境差异


* 同构渲染：首屏将会使用服务端渲染，然后客户端接管页面交互，优缺点并存互补。
  + 同构渲染（SSR）：是前后端渲染结合的产物，借助node环境，在服务端初始化html，友好的首屏体验及SEO。同时在客户端运行js优化交互体验。
  + 解决了代码耦合，首屏渲染慢，和SEO的问题，但相对于客户端渲染给服务端的压力会较大一些。
  

### 二、用过哪些服务端渲染方案？
主流的方案：Next.js(针对react)，   Nuxt.js(针对vue的)。
因为是react的项目，所以这里我们用了`Next.js`



### 三、next.js帮助解决下列问题
必须使用打包程序（例如 webpack）打包代码，并使用 Babel 等编译器进行代码转换。
你需要针对生产环境进行优化，例如代码拆分。
你可能需要对一些页面进行预先渲染以提高页面性能和 SEO。你可能还希望使用服务器端渲染或客户端渲染。
你可能必须编写一些服务器端代码才能将 React 应用程序连接到数据存储。

### 四、next.js开发人员体验和内置功能
Next.js 具有同类框架中最佳的“开发人员体验”和许多内置功能。列举其中一些如下：

1、直观的、 基于页面 的路由系统（并支持 动态路由）
2、预渲染。支持在页面级的 静态生成 (SSG) 和 服务器端渲染 (SSR)
3、自动代码拆分，提升页面加载速度
4、具有经过优化的预取功能的 客户端路由
5、内置 CSS 和 Sass 的支持，并支持任何 CSS-in-JS 库
6、开发环境支持 快速刷新
7、利用 Serverless Functions 及 API 路由 构建 API 功能
8、完全可扩展


### 五、SSR 解决了什么问题？
现代化的前端项目都是spa，所有数据都是从服务器获取的，然后处理显示在前端，这就是CSR(Client Side Render)。

1、spa应用最大的两个问题
（1）白屏时间更长，用户体验不好。
（2）html中无内容，SEO不友好。
单页所有东西都在一起，一个script 可能要经过好几轮后端请求才请求回来，导致页面空白没有数据。
seo爬虫只会请求你的服务器页面，发现没有内容就走了，爬虫不能把你的网站收录，百度/google也就搜不到你的网站了。


### 六、什么是服务端渲染（SSR),谈一下他的优缺点
无论你哪个页面需要做服务端渲染，都可以写成服务端渲染的。但是一般都是首页的才写成服务端渲染。
如果用框架的话，一般要用SSR。
1、服务端渲染：
简单理解就是将组件或页面通过服务器生成 html 字符串(纯静态页面)，再发送到浏览器。保证用户看到客户端是有内容的，不是空的。之后要请求js代码再正常去请求。
当用户第一次请求页面时，客户端拿到手的，是可以直接渲染然后呈现给用户的html内容，不需要为了生成dom内容自己再去跑一遍js代码。
2、流程：
（1）客户端请求一个地址
（2）服务端---> 去接口服务里查询页面所需数据--> 返回数据给服务端
（3）服务端返回html（渲染好的页面内容+客户端SPA脚本）
（4）客户端呈现服务端返回的html--->首页加载是纯静态的，没有react也无所谓。
（5）客户端通过页面中的脚本激活为SPA应用。
（6）之后的页面交互都是客户端渲染。（如果是react里使用ssr，后续第6步再去请求react，react-dom之类的代码）

3、服务端渲染SSR优点
- 首屏渲染快
- 利于SEO
- 可以生成缓存片段，生成静态化文件
- 
4、服务端渲染SSR 缺点：
在服务器端进行web页面渲染，服务器压力大，用户体验一般，前端后端代码耦合。
- 服务端压力较大
- 开发条件受限
- 学习成本相对较高


### 七、next的部署方式有什么区别？
和一般spa 没什么区别。打包好之后直接给后端就可以。
导出：直接build就可以。

### 八、老项目怎么做 SSR?
1、先生成next.js 应用
2、把老项目导出来，然后再改改。
3、需要做服务端渲染和静态页面/导出的组件，需要去具体的组件里面改代码，加代码。
4、经验：原来的spa项目改成next项目，代码的改动量在10%左右。
只能一个个去改，没有那种平滑的更新。



